const VERTEX_SHADER="attribute vec4 aPosition;\nattribute vec2 aTexCoord;\nvarying vec2 vUv;\nvarying vec2 vScreenPosition;\n\nvoid main() {\n    gl_Position = aPosition;\n    vUv = aTexCoord;\n    vScreenPosition = aPosition.xy;\n}",FRAGMENT_SHADER="precision highp float;\n\nuniform float uTime;\nuniform vec2 uResolution;\nuniform sampler2D uTexture;\nuniform sampler2D uTextureNext;\nuniform float uTransition;\nuniform vec2 uMousePosition;\nuniform float uDirection;\nuniform float uAutoRotationX;\nuniform float uUnwrapProgress;\nuniform float uRotation;\nuniform float uStretchV;\nuniform float uZoom;\nvarying vec2 vUv;\nvarying vec2 vScreenPosition;\n\n#define PI 3.1415926535897932384626433832795\n#define CAMERA_DIST 25.0\n\nvec3 getFishEye(vec2 uv, float level) {\n    float len = length(uv);\n    float a = len * level;\n    return vec3(uv / len * sin(a), -cos(a));\n}\n\nvec3 getColor(vec2 p, sampler2D tex) {\n    vec2 baseUV = (p + 1.0) * 0.5;\n    \n    float containerAspect = uResolution.x / uResolution.y;\n    float scale = 1.0;\n    \n    if (containerAspect < 1.0) {\n        scale = containerAspect;\n        baseUV.x = baseUV.x * scale + (1.0 - scale) * 0.5;\n    } else {\n        scale = 1.0 / containerAspect;\n        baseUV.y = baseUV.y * scale + (1.0 - scale) * 0.5;\n    }\n    \n    baseUV.y = 1.0 - baseUV.y;\n    \n    vec3 baseColor = texture2D(tex, baseUV).xyz;\n    return baseColor;\n}\n\nvoid main() {\n    vec2 p = vScreenPosition.xy;\n    \n    vec4 fragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    \n    float t = uUnwrapProgress;\n    \n    float zoom = pow(2.0 * t, 5.0) + 1.0;\n    \n    zoom *= uZoom;\n    \n    float aspect = uResolution.x / uResolution.y;\n    \n    vec3 dir;\n    if (aspect >= 1.0) {\n        dir = normalize(vec3(p.x * aspect * PI, p.y * PI, -zoom * (CAMERA_DIST - 1.0)));\n    } else {\n        dir = normalize(vec3(p.x * PI, p.y / aspect * PI, -zoom * (CAMERA_DIST - 1.0)));\n    }\n    \n    float b = CAMERA_DIST * dir.z;\n    float h = b*b - CAMERA_DIST*CAMERA_DIST + 1.0;\n    \n    if (h >= 0.0) {\n        vec3 q = vec3(0.0, 0.0, CAMERA_DIST) - dir * (b + sqrt(h));\n        \n        float cosRot = cos(uRotation * PI * 2.0);\n        float sinRot = sin(uRotation * PI * 2.0);\n        mat3 rotationMatrix = mat3(\n            cosRot, 0.0, -sinRot,\n            0.0, 1.0, 0.0,\n            sinRot, 0.0, cosRot\n        );\n        \n        q = rotationMatrix * q;\n        \n        vec3 normal = normalize(q);\n        float u = atan(normal.x, normal.z) / (2.0 * PI);\n        float v = 1.0 - acos(normal.y) / PI;\n        vec2 sphereCoords = vec2(u, v);\n        \n        p = sphereCoords * zoom;\n        \n        vec3 currentColor = getColor(p, uTexture);\n        vec3 nextColor = getColor(p, uTextureNext);\n        \n        float mixFactor = smoothstep(0.0, 1.0, uTransition);\n        vec3 color = mix(currentColor, nextColor, mixFactor);\n        \n        vec3 fisheyeDir = getFishEye(vScreenPosition.xy, 1.4);\n        \n        float fisheyeMix = smoothstep(0.0, 1.0, t);\n        vec2 finalCoords = mix(sphereCoords, fisheyeDir.xy, fisheyeMix);\n        \n        currentColor = getColor(finalCoords, uTexture);\n        nextColor = getColor(finalCoords, uTextureNext);\n        color = mix(currentColor, nextColor, mixFactor);\n        \n        if (t >= 1.0) {\n            float mouseX = -(uMousePosition.x - 0.5);\n            float mouseY = -(uMousePosition.y - 0.5);\n            float mouseInfluenceX = 0.3;\n            float mouseInfluenceY = 0.2;\n            \n            float mouseRotationX = mouseX * mouseInfluenceX * PI;\n            float mouseRotationY = mouseY * mouseInfluenceY * PI;\n            \n            float transitionRotation = uTransition * PI * 2.0 * uDirection;\n            float autoRotation = uAutoRotationX;\n            \n            mat2 mouseRotationMatrixX = mat2(\n                cos(mouseRotationX), -sin(mouseRotationX),\n                sin(mouseRotationX), cos(mouseRotationX)\n            );\n            \n            mat2 mouseRotationMatrixY = mat2(\n                cos(mouseRotationY), -sin(mouseRotationY),\n                sin(mouseRotationY), cos(mouseRotationY)\n            );\n            \n            mat2 transitionRotationMatrix = mat2(\n                cos(transitionRotation), -sin(transitionRotation),\n                sin(transitionRotation), cos(transitionRotation)\n            );\n            \n            mat2 autoRotationMatrix = mat2(\n                cos(autoRotation), -sin(autoRotation),\n                sin(autoRotation), cos(autoRotation)\n            );\n            \n            fisheyeDir.xz = mouseRotationMatrixX * fisheyeDir.xz;\n            fisheyeDir.yz = mouseRotationMatrixY * fisheyeDir.yz;\n            fisheyeDir.xz = transitionRotationMatrix * fisheyeDir.xz;\n            fisheyeDir.xz = autoRotationMatrix * fisheyeDir.xz;\n            \n            currentColor = getColor(fisheyeDir.xy, uTexture);\n            nextColor = getColor(fisheyeDir.xy, uTextureNext);\n            color = mix(currentColor, nextColor, mixFactor);\n        }\n        \n        float fish_eye = smoothstep(2.0, 1.6, length(vScreenPosition.xy)) * 0.15 + 0.85;\n        \n        fragColor = vec4(color * fish_eye, 1.0);\n    }\n    \n    gl_FragColor = fragColor;\n}";class CustomGallery{constructor(){this.mainWrapper=document.querySelector('[data-gallery="main-wrapper"]'),this.container=document.querySelector('[data-gallery="container"]'),this.container.style.width="100%",this.container.style.height="100%",this.slides=document.querySelectorAll('[data-gallery="slide"]'),this.prevButton=document.querySelector('[data-gallery="prev"]'),this.nextButton=document.querySelector('[data-gallery="next"]'),this.currentSlide=0,this.slideCount=this.slides.length,this.isAnimating=!1,this.paginationWrapper=document.querySelector('[data-gallery="pagination-wrapper"]'),this.dots=document.querySelectorAll('[data-gallery="pagination-bullet"]:not([data-template="true"])'),this.textContainers=document.querySelectorAll('[data-gallery="text-container"]'),this.initialAnimationPlayed=!1,this.isInitialAnimationPlaying=!1,this.textAnimationStarted=!1,this.autoRotationStartedAfterIntro=!1,this.splitTextInstances=[],this.autoplayInterval=null,this.autoplayDelay=5e3,this.addTransitionStyles(),this.hideElementsDuringIntro(),this.initSplitText(),!this.paginationWrapper||this.dots&&0!==this.dots.length||this.createPaginationBullets(),this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.zIndex="1",this.container.appendChild(this.canvas),this.gl=this.canvas.getContext("webgl",{alpha:!0,premultipliedAlpha:!1})||this.canvas.getContext("experimental-webgl",{alpha:!0,premultipliedAlpha:!1}),this.gl?(this.useWebGL=!0,this.initWebGL()):this.useWebGL=!1,this.startTime=performance.now(),this.mousePosition={x:.5,y:.5},this.targetMousePosition={x:.5,y:.5},this.isMouseInputEnabled=!1,this.mouseInterpolationFactor=0,this.params={transition:0,direction:1,autoRotationX:0,unwrapProgress:0,rotation:0,stretchV:1,zoom:1},this.isTouchOnly=!1,this.detectTouchOnlyDevice(),this.showSlide(this.currentSlide,!0),this.playInitialAnimation(),this.prevButton.addEventListener("click",(()=>{this.isAnimating||this.isInitialAnimationPlaying||(this.params.direction=1,this.changeSlide(-1))})),this.nextButton.addEventListener("click",(()=>{this.isAnimating||this.isInitialAnimationPlaying||(this.params.direction=-1,this.changeSlide(1))})),this.dots.forEach(((t,i)=>{t.addEventListener("click",(()=>{if(this.isAnimating||this.isInitialAnimationPlaying)return;if(this.currentSlide===i)return;this.resetAutoplay(),this.isTouchOnly&&this.stopAutoRotation(),this.params.direction=i>this.currentSlide?-1:1;const t=this.slides[this.currentSlide].querySelector('[data-gallery="text-container"]');t&&!this.isInitialAnimationPlaying?this.animateTextOut(t).then((()=>{this.currentSlide=i,this.showSlide(this.currentSlide)})):(this.currentSlide=i,this.showSlide(this.currentSlide))}))})),window.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.setupSwipe(),this.setupKeyboardNavigation(),this.animate()}initWebGL(){this.resizeCanvasToDisplaySize(),window.addEventListener("resize",(()=>this.resizeCanvasToDisplaySize()));const t=this.createShader(this.gl.VERTEX_SHADER,VERTEX_SHADER),i=this.createShader(this.gl.FRAGMENT_SHADER,FRAGMENT_SHADER);this.program=this.createProgram(t,i),this.positionLocation=this.gl.getAttribLocation(this.program,"aPosition"),this.texCoordLocation=this.gl.getAttribLocation(this.program,"aTexCoord"),this.timeLocation=this.gl.getUniformLocation(this.program,"uTime"),this.resolutionLocation=this.gl.getUniformLocation(this.program,"uResolution"),this.mousePositionLocation=this.gl.getUniformLocation(this.program,"uMousePosition"),this.transitionLocation=this.gl.getUniformLocation(this.program,"uTransition"),this.directionLocation=this.gl.getUniformLocation(this.program,"uDirection"),this.textureLocation=this.gl.getUniformLocation(this.program,"uTexture"),this.textureNextLocation=this.gl.getUniformLocation(this.program,"uTextureNext"),this.autoRotationXLocation=this.gl.getUniformLocation(this.program,"uAutoRotationX"),this.unwrapProgressLocation=this.gl.getUniformLocation(this.program,"uUnwrapProgress"),this.rotationLocation=this.gl.getUniformLocation(this.program,"uRotation"),this.stretchVLocation=this.gl.getUniformLocation(this.program,"uStretchV"),this.zoomLocation=this.gl.getUniformLocation(this.program,"uZoom");const e=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this.positionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW);const n=new Float32Array([0,1,1,1,0,0,1,0]);this.texCoordBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texCoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW),this.texture=this.createTexture(),this.nextTexture=this.createTexture(),this.loadImageTexture(this.slides[0].querySelector('[data-gallery="image"]').src,this.texture)}createShader(t,i){const e=this.gl.createShader(t);return this.gl.shaderSource(e,i),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)?e:(this.gl.deleteShader(e),null)}createProgram(t,i){const e=this.gl.createProgram();return this.gl.attachShader(e,t),this.gl.attachShader(e,i),this.gl.linkProgram(e),this.gl.getProgramParameter(e,this.gl.LINK_STATUS)?e:null}createTexture(){const t=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);const i=new Uint8Array([0,0,0,255]);return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),t}loadImageTexture(t,i){return new Promise((e=>{const n=new Image;n.crossOrigin="anonymous",n.onload=()=>{this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),e()},n.src=t}))}resizeCanvasToDisplaySize(t){const i=this.canvas,e=i.clientWidth,n=i.clientHeight;i.width===e&&i.height===n||(i.width=e,i.height=n,this.gl.viewport(0,0,e,n))}handleMouseMove(t){if(!this.isMouseInputEnabled||this.isTouchOnly||this.isInitialAnimationPlaying)return;const i=t.clientX/window.innerWidth,e=1-t.clientY/window.innerHeight;this.targetMousePosition={x:Math.min(Math.max(i,0),1),y:Math.min(Math.max(e,0),1)}}async showSlide(t,i=!1){if(!this.isAnimating||i)if(this.isAnimating=!0,this.currentSlide=t,this.dots.forEach(((e,n)=>{e.removeAttribute("data-active");const s=e.querySelector('[data-gallery="bullet-progress"]');if(s&&!i&&gsap.to(s,{scaleX:0,duration:.3,ease:"power1.out"}),n===t){e.setAttribute("data-active","true");const t=e.querySelector('[data-gallery="bullet-progress"]');t&&!i&&(gsap.set(t,{scaleX:0}),gsap.to(t,{scaleX:1,duration:1.2,ease:"power2.inOut"}))}})),this.slides.forEach((t=>{t.style.display="none"})),this.slides[t].style.display="block",this.useWebGL){if(await this.loadImageTexture(this.slides[t].querySelector('[data-gallery="image"]').src,this.nextTexture),i)return[this.texture,this.nextTexture]=[this.nextTexture,this.texture],this.params.transition=0,this.isAnimating=!1,void(this.isTouchOnly&&this.initialAnimationPlayed&&(this.params.autoRotationX=0,this.startAutoRotation(0)));this.params.autoRotationX;this.isTouchOnly&&this.initialAnimationPlayed&&(this.autoRotationTween&&(this.autoRotationTween.kill(),this.autoRotationTween=null),gsap.to(this.params,{autoRotationX:0,duration:1.2,ease:"power2.inOut"})),gsap.to(this.params,{transition:1,duration:1.2,ease:"power2.inOut",onUpdate:()=>{if(this.params.transition>.95&&!this.textAnimationStarted&&(this.textAnimationStarted=!0,!this.isInitialAnimationPlaying)){const i=this.slides[t].querySelector('[data-gallery="text-container"]');i&&(gsap.set(i,{opacity:1}),this.animateTextIn(i))}},onComplete:()=>{[this.texture,this.nextTexture]=[this.nextTexture,this.texture],this.params.transition=0,this.isAnimating=!1,this.textAnimationStarted=!1,this.isTouchOnly&&this.initialAnimationPlayed&&(this.params.autoRotationX=0,this.startAutoRotation(0))}})}else setTimeout((()=>{if(this.isAnimating=!1,!this.isInitialAnimationPlaying){const i=this.slides[t].querySelector('[data-gallery="text-container"]');i&&(gsap.set(i,{opacity:1}),this.animateTextIn(i))}}),600)}changeSlide(t){if(this.isAnimating)return;this.resetAutoplay(),this.isTouchOnly&&this.stopAutoRotation();const i=this.slides[this.currentSlide].querySelector('[data-gallery="text-container"]'),e=(this.currentSlide+t+this.slideCount)%this.slideCount;i&&!this.isInitialAnimationPlaying?this.animateTextOut(i).then((()=>{this.currentSlide=e,this.showSlide(this.currentSlide)})):(this.currentSlide=e,this.showSlide(this.currentSlide))}stopAutoRotation(){this.autoRotationTween&&(this.autoRotationTween.kill(),this.autoRotationTween=null)}render(){if(!this.useWebGL||!this.gl)return;this.resizeCanvasToDisplaySize(),this.isMouseInputEnabled&&(this.mouseInterpolationFactor+=.05*(.1-this.mouseInterpolationFactor));const t=this.mouseInterpolationFactor,i=.7*this.mouseInterpolationFactor;this.mousePosition.x+=(this.targetMousePosition.x-this.mousePosition.x)*t,this.mousePosition.y+=(this.targetMousePosition.y-this.mousePosition.y)*i,this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.disable(this.gl.CULL_FACE),this.gl.useProgram(this.program),this.gl.uniform1f(this.timeLocation,(performance.now()-this.startTime)/1e3),this.gl.uniform2f(this.resolutionLocation,this.gl.canvas.width,this.gl.canvas.height),this.gl.uniform2f(this.mousePositionLocation,this.mousePosition.x,this.mousePosition.y),this.gl.uniform1f(this.transitionLocation,this.params.transition),this.gl.uniform1f(this.directionLocation,this.params.direction),this.gl.uniform1f(this.autoRotationXLocation,this.params.autoRotationX),this.gl.uniform1f(this.unwrapProgressLocation,this.params.unwrapProgress),this.gl.uniform1f(this.rotationLocation,this.params.rotation),this.gl.uniform1f(this.stretchVLocation,this.params.stretchV),this.gl.uniform1f(this.zoomLocation,this.params.zoom),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.uniform1i(this.textureLocation,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.nextTexture),this.gl.uniform1i(this.textureNextLocation,1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.texCoordBuffer),this.gl.enableVertexAttribArray(this.texCoordLocation),this.gl.vertexAttribPointer(this.texCoordLocation,2,this.gl.FLOAT,!1,0,0),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}setupSwipe(){let t,i;const e=i=>{this.isAnimating||(t="mousedown"===i.type?i.clientX:i.touches[0].clientX,document.addEventListener("mousemove",n),document.addEventListener("touchmove",n),document.addEventListener("mouseup",s),document.addEventListener("touchend",s))},n=t=>{i="mousemove"===t.type?t.clientX:t.touches[0].clientX},s=()=>{if(!i||this.isAnimating)return;const e=i-t;Math.abs(e)>100&&(this.resetAutoplay(),this.isTouchOnly&&this.stopAutoRotation(),e>0?(this.params.direction=1,this.changeSlide(-1)):(this.params.direction=-1,this.changeSlide(1))),document.removeEventListener("mousemove",n),document.removeEventListener("touchmove",n),document.removeEventListener("mouseup",s),document.removeEventListener("touchend",s),i=null};this.container.addEventListener("mousedown",e),this.container.addEventListener("touchstart",e),this.container.addEventListener("mouseenter",(()=>{this.stopAutoplay()})),this.container.addEventListener("mouseleave",(()=>{this.initialAnimationPlayed&&this.startAutoplay()}))}setupKeyboardNavigation(){document.addEventListener("keydown",(t=>{if(!this.isAnimating&&!this.isInitialAnimationPlaying)switch(t.key){case"ArrowLeft":this.isTouchOnly&&this.stopAutoRotation(),this.resetAutoplay(),this.params.direction=1,this.changeSlide(-1);break;case"ArrowRight":this.isTouchOnly&&this.stopAutoRotation(),this.resetAutoplay(),this.params.direction=-1,this.changeSlide(1);break}}))}animate(){this.render(),requestAnimationFrame((()=>this.animate()))}playInitialAnimation(){!this.initialAnimationPlayed&&this.useWebGL&&(window.scrollY>=10?this.skipInitialAnimation():setTimeout((()=>{this.isInitialAnimationPlaying=!0,this.params.unwrapProgress=0,this.params.zoom=0,this.params.rotation=0,this.isAnimating=!0;gsap.timeline({onComplete:()=>{this.isAnimating=!1,this.initialAnimationPlayed=!0,this.isInitialAnimationPlaying=!1,this.showElementsAfterIntro(),this.isTouchOnly&&(this.params.autoRotationX=0,this.startAutoRotation(0)),this.startAutoplay(),setTimeout((()=>{this.isMouseInputEnabled=!0,this.mouseInterpolationFactor=0}),800);const t=new CustomEvent("galleryInitialAnimationComplete");document.dispatchEvent(t)}}).to(this.params,{rotation:2,zoom:.8,duration:2,ease:"none"}).to(this.params,{zoom:1,unwrapProgress:1,duration:1.3,ease:"power2.Out"})}),200))}skipInitialAnimation(){this.params.unwrapProgress=1,this.params.zoom=1,this.params.rotation=0,this.showElementsAfterIntro(),this.initialAnimationPlayed=!0,this.isInitialAnimationPlaying=!1,this.isMouseInputEnabled=!0,this.mouseInterpolationFactor=0,this.isTouchOnly&&(this.params.autoRotationX=0,this.startAutoRotation(0)),this.startAutoplay();const t=new CustomEvent("galleryInitialAnimationComplete");document.dispatchEvent(t)}hideElementsDuringIntro(){this.prevButton&&(this.prevButton.style.opacity="0"),this.nextButton&&(this.nextButton.style.opacity="0"),this.paginationWrapper&&(this.paginationWrapper.style.opacity="0"),this.textContainers.forEach((t=>{t.style.opacity="0"}))}showElementsAfterIntro(){this.prevButton&&gsap.to(this.prevButton,{opacity:1,duration:.3,delay:.1}),this.nextButton&&gsap.to(this.nextButton,{opacity:1,duration:.3,delay:.1}),this.paginationWrapper&&gsap.to(this.paginationWrapper,{opacity:1,duration:.3,delay:.1});const t=this.slides[this.currentSlide];if(t){const i=t.querySelector('[data-gallery="text-container"]');i&&(gsap.set(i,{opacity:1}),this.animateTextIn(i))}}createPaginationBullets(){const t=this.paginationWrapper.querySelector('[data-gallery="pagination-bullet"][data-template="true"]'),i=this.paginationWrapper.querySelectorAll('[data-gallery="pagination-bullet"]:not([data-template="true"])');if(i.length===this.slides.length)return i.forEach(((t,i)=>{t.removeAttribute("data-active"),i===this.currentSlide&&t.setAttribute("data-active","true"),t.addEventListener("click",(()=>{if(this.isAnimating||this.isInitialAnimationPlaying)return;if(this.currentSlide===i)return;this.resetAutoplay(),this.isTouchOnly&&this.stopAutoRotation(),this.params.direction=i>this.currentSlide?-1:1;const t=this.slides[this.currentSlide].querySelector('[data-gallery="text-container"]');t&&!this.isInitialAnimationPlaying?this.animateTextOut(t).then((()=>{this.currentSlide=i,this.showSlide(this.currentSlide)})):(this.currentSlide=i,this.showSlide(this.currentSlide))}))})),void(this.dots=i);if(t){const e=t.cloneNode(!0);i.forEach((t=>t.remove()));for(let t=0;t<this.slides.length;t++){const i=e.cloneNode(!0);i.removeAttribute("data-template"),i.style.display="",t===this.currentSlide?i.setAttribute("data-active","true"):i.removeAttribute("data-active"),i.addEventListener("click",(()=>{if(this.isAnimating||this.isInitialAnimationPlaying)return;if(this.currentSlide===t)return;this.resetAutoplay(),this.isTouchOnly&&this.stopAutoRotation(),this.params.direction=t>this.currentSlide?-1:1;const i=this.slides[this.currentSlide].querySelector('[data-gallery="text-container"]');i&&!this.isInitialAnimationPlaying?this.animateTextOut(i).then((()=>{this.currentSlide=t,this.showSlide(this.currentSlide)})):(this.currentSlide=t,this.showSlide(this.currentSlide))})),this.paginationWrapper.appendChild(i)}}else{this.paginationWrapper.innerHTML="";for(let t=0;t<this.slides.length;t++){const i=document.createElement("div");i.setAttribute("data-gallery","pagination-bullet"),t===this.currentSlide&&i.setAttribute("data-active","true");const e=document.createElement("div");e.setAttribute("data-gallery","bullet-progress"),i.appendChild(e),i.addEventListener("click",(()=>{if(this.isAnimating||this.isInitialAnimationPlaying)return;if(this.currentSlide===t)return;this.resetAutoplay(),this.isTouchOnly&&this.stopAutoRotation(),this.params.direction=t>this.currentSlide?-1:1;const i=this.slides[this.currentSlide].querySelector('[data-gallery="text-container"]');i&&!this.isInitialAnimationPlaying?this.animateTextOut(i).then((()=>{this.currentSlide=t,this.showSlide(this.currentSlide)})):(this.currentSlide=t,this.showSlide(this.currentSlide))})),this.paginationWrapper.appendChild(i)}}this.dots=document.querySelectorAll('[data-gallery="pagination-bullet"]:not([data-template="true"])')}addTransitionStyles(){const t=document.createElement("style");t.textContent='[data-gallery="prev"], [data-gallery="next"], [data-gallery="pagination-wrapper"], [data-gallery="text-container"] {    transition: opacity 0.3s ease;}[data-gallery="bullet-progress"] {    display: block;    width: 100%;    height: 100%;    transform-origin: left center;    transform: scaleX(0);}[data-gallery="pagination-bullet"][data-active="true"] [data-gallery="bullet-progress"] {    transform: scaleX(1);}[data-gallery="pagination-bullet"][data-template="true"] {    display: none;}',document.head.appendChild(t)}detectTouchOnlyDevice(){this.isTouchOnly=("ontouchstart"in window||navigator.maxTouchPoints>0)&&!window.matchMedia("(pointer: fine)").matches}startAutoRotation(t=0){this.autoRotationTween&&this.autoRotationTween.kill(),this.params.autoRotationX=t;this.autoRotationTween=gsap.to(this.params,{autoRotationX:t+2*Math.PI,duration:30,ease:"none",delay:0,repeat:-1,onRepeat:()=>{this.params.autoRotationX=this.params.autoRotationX%(2*Math.PI)}})}initSplitText(){this.textContainers.forEach((t=>{const i=t.querySelector('[data-gallery-text="title"]'),e=t.querySelector('[data-gallery-text="author"]');if(i){const t=new SplitText(i,{type:"chars,words",position:"relative"});gsap.set(t.chars,{y:20,opacity:0}),this.splitTextInstances.push({element:i,split:t})}if(e){const t=new SplitText(e,{type:"chars,words",position:"relative"});gsap.set(t.chars,{y:20,opacity:0}),this.splitTextInstances.push({element:e,split:t})}}))}animateTextIn(t){if(!t)return;const i=t.querySelector('[data-gallery-text="title"]'),e=t.querySelector('[data-gallery-text="author"]'),n=this.splitTextInstances.find((t=>t.element===i)),s=this.splitTextInstances.find((t=>t.element===e));n&&gsap.to(n.split.chars,{opacity:1,y:0,duration:.4,stagger:.02,ease:"power2.out"}),s&&gsap.to(s.split.chars,{opacity:1,y:0,duration:.4,stagger:.02,delay:.2,ease:"power2.out"})}animateTextOut(t){return new Promise((i=>{if(!t)return void i();const e=t.querySelector('[data-gallery-text="title"]'),n=t.querySelector('[data-gallery-text="author"]'),s=this.splitTextInstances.find((t=>t.element===e)),o=this.splitTextInstances.find((t=>t.element===n));s&&o?(gsap.to(o.split.chars,{opacity:0,y:-20,duration:.2,stagger:.01,ease:"power2.in"}),gsap.to(s.split.chars,{opacity:0,y:-20,duration:.2,stagger:.01,delay:.05,ease:"power2.in",onComplete:i})):gsap.to(t,{opacity:0,duration:.2,ease:"power1.out",onComplete:i})}))}startAutoplay(){this.stopAutoplay(),this.autoplayInterval=setInterval((()=>{this.isAnimating||this.isInitialAnimationPlaying||(this.params.direction=-1,this.changeSlide(1))}),this.autoplayDelay)}stopAutoplay(){this.autoplayInterval&&(clearInterval(this.autoplayInterval),this.autoplayInterval=null)}resetAutoplay(){this.stopAutoplay(),this.startAutoplay()}}document.addEventListener("DOMContentLoaded",(()=>{new CustomGallery})),window.CustomGallery=CustomGallery;